# å‰ç«¯è‡ªæµ‹æ–¹æ³•æ–‡æ¡£

## å‡†å¤‡å·¥ä½œ

1. æœ‰ä¸ªç¬”è®°æœ¬ç”µè„‘ä¸”èƒ½è¿CMBC-Tï¼ˆæœ€å¥½æ˜¯Macï¼Œè¿™æ ·iPhoneå’ŒAndroidéƒ½èƒ½è°ƒï¼›å¦‚æœæ˜¯Windowsï¼Œé‚£æœ€å¥½é…ä¸ªAndroidæ‰‹æœºï¼‰ã€‚
2. ä¸‹è½½ã€å®‰è£…Charlesä»£ç†è½¯ä»¶ï¼ˆMacOS/Windowså‡æœ‰ï¼‰ã€‚
3. 
   - å¦‚æœæ˜¯Macï¼Œå¯ä»¥è£…Xcodeï¼Œå¹¶clone iOSä»£ç æ¥è¿è¡ŒiOS Simulatorsï¼ˆè¿™æ ·ä½ å°±æœ‰ä¸€å°è™šæ‹ŸiPhoneäº†ï¼‰ã€‚
   - æ— è®ºMacè¿˜æ˜¯Windowséƒ½å¯ä»¥è£…Android Studioï¼Œå¹¶clone Androidä»£ç æ¥ä¸ºè‡ªå·±Androidæ‰‹æœºæ‰“åŒ…äº†ã€‚
4. cloneå‰ç«¯ä»£ç ï¼Œä»“åº“åœ°å€`git-server:fe/static_resources`ã€‚

## åˆå§‹é…ç½®

> æ­¤å¤„ä»¥Macä¸¾ä¾‹ã€Windowsç±»ä¼¼ã€‚

1. ä»é™„ä»¶è·å–Charles.javaï¼Œå°†å…¶ç§»åŠ¨è‡³Charlesçš„å®‰è£…ç›®å½•ä¸‹çš„`/åº”ç”¨ç¨‹åº/Charles.app/Contents/Java/`è·¯å¾„å¹¶è¦†ç›–æ‰åŸæ–‡ä»¶ï¼ŒWindowsçš„è·¯å¾„æ˜¯`Â·Â·Â·/Charles/lib/`ï¼ˆæƒ³ä¹°æ­£ç‰ˆè¯·å¿½ç•¥è¿™ä¸€æ­¥ğŸ˜Š â€‹â€‹ï¼‰ã€‚

2. æ‰“å¼€Charlesï¼Œè‡ªå·±å¯ä»¥æ…¢æ…¢æ‘¸ç´¢ä½¿ç”¨ï¼Œè¿™é‡Œåªè®²å¦‚ä½•è®©è‡ªå·±è°ƒè¯•ã€‚é¦–å…ˆå®‰è£…æ ¹è¯ä¹¦ï¼š

![image-20180919171222019](/Users/panhui/Library/Application Support/typora-user-images/image-20180919171222019.png)

ç‚¹å‡»åä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š

![image-20180919171603255](/Users/panhui/Library/Application Support/typora-user-images/image-20180919171603255.png)

è¿™æ—¶åŒå‡»å®ƒï¼Œé€‰æ‹©â€œå§‹ç»ˆä¿¡ä»»â€åå…³é—­ï¼ˆä¸€èˆ¬è¦éªŒè¯å¯†ç ï¼‰ï¼Œå°±å¯ä»¥äº†ï¼š

![image-20180919171711394](/Users/panhui/Library/Application Support/typora-user-images/image-20180919171711394.png)

ï¼ˆå¦‚æœæ˜¯Windowsç³»ç»Ÿï¼Œåº”è¯¥ä¼šæœ‰ä¸€ä¸ªè¯ä¹¦å®‰è£…çš„å‘å¯¼ï¼Œåœ¨å¦‚ä¸‹è¿™ä¸€æ­¥è¯·é€‰æ‹©â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€ï¼Œå¦‚ä¸‹å›¾ï¼šï¼‰

![image-20180919171821743](/Users/panhui/Library/Application Support/typora-user-images/image-20180919171821743.png)

3. ä»£ç†è®¾ç½®ï¼Œé€‰æ‹©`Proxy->Proxy Settingsâ€¦`ï¼Œå¦‚ä¸‹å›¾ï¼š

![image-20180919172046880](/Users/panhui/Library/Application Support/typora-user-images/image-20180919172046880.png)

![image-20180919172131330](/Users/panhui/Library/Application Support/typora-user-images/image-20180919172131330.png)

åœ¨`HTTP Proxy`ä¸­çš„`Port`ä¸­å¡«å…¥ç«¯å£å·ï¼ˆé»˜è®¤8888ï¼‰ï¼Œå¹¶å‹¾é€‰`Enable transparent HTTP proxying`ï¼Œç„¶å`OK`ã€‚

4. SSLä»£ç†è®¾ç½®ï¼š

   ![image-20180919172842763](/Users/panhui/Library/Application Support/typora-user-images/image-20180919172842763.png)

   åœ¨ç•Œé¢ä¸­ç‚¹å‡»`Add`å¡«å†™è¦ä»£ç†çš„åŸŸåå’Œç«¯å£å·ï¼Œå¦‚å›¾ï¼ˆæˆ‘åªå¡«äº†UATå’ŒSITçš„åœ°å€ï¼Œå…¶ä»–æœåŠ¡å™¨åœ°å€ç±»ä¼¼ï¼‰ï¼š

   ![image-20180919173014202](/Users/panhui/Library/Application Support/typora-user-images/image-20180919173014202.png)

5. æœ¬åœ°æ˜ å°„ï¼Œå¦‚å›¾ï¼š

   ![image-20180919182926489](/Users/panhui/Library/Application Support/typora-user-images/image-20180919182926489.png)

   å‹¾é€‰`Enable Map Local`ï¼Œç‚¹å‡»`add`æ·»åŠ è§„åˆ™ï¼ˆæˆ‘è¿™é‡Œæ‹¿SITé™æ€èµ„æºåœ°å€ä¸¾ä¾‹ï¼‰ï¼Œ`Local path`é€‰æ‹©æœ¬åœ°çš„ä»£ç `Â·Â·Â·/static_resources/src`ï¼šï¼š

   ![image-20180919183021457](/Users/panhui/Library/Application Support/typora-user-images/image-20180919183021457.png)

   è¿™æ ·ï¼Œè¯·æ±‚å‘æœåŠ¡å™¨çš„é™æ€èµ„æºå°±ä¼šè¢«æ˜ å°„è‡³æœ¬åœ°çš„æ–‡ä»¶ï¼Œæœ¬åœ°æ–‡ä»¶ä¸€ä¿®æ”¹ã€ä¿å­˜ï¼Œé¡µé¢ä¸€åˆ·æ–°å°±èƒ½ç«‹å³çœ‹åˆ°æ•ˆæœï¼ˆ**å¦‚æœè¦è°ƒè¯•æœåŠ¡å™¨ä¸Šçš„é™æ€èµ„æºè€Œä¸æ˜¯æœ¬åœ°çš„ï¼Œè¯·å–æ¶ˆè¿™ä¸€æ­¥çš„æœ¬åœ°æ˜ å°„ï¼**ï¼‰ã€‚

6. å¦‚æœæ˜¯çœŸæœºè°ƒè¯•ï¼Œè¯·å…ˆå°†æ‰‹æœºå’Œç¬”è®°æœ¬ç”µè„‘éƒ½è¿è‡³CMBC-Tï¼Œç„¶åç‚¹å‡»å¦‚å›¾ï¼š

   ![image-20180919172648997](/Users/panhui/Library/Application Support/typora-user-images/image-20180919172648997.png)

   è¿™æ—¶ä¼šå‡ºç°ä¸€ä¸ªæç¤ºï¼š![image-20180919173106607](/Users/panhui/Library/Application Support/typora-user-images/image-20180919173106607.png)

   è¿™æ—¶å°†è‡ªå·±æ‰‹æœºçš„CMBC-Tçš„ä»£ç†è®¾ç½®æˆæ‰‹åŠ¨ï¼Œä»£ç†ä¸»æœºå’Œç«¯å£å·åˆ†åˆ«å¡«å†™ä½ ç”µè„‘æç¤ºçš„ï¼ˆå…¶å®å°±æ˜¯ä½ ç”µè„‘çš„ipå’Œåˆšæ‰è®¾ç½®çš„ç«¯å£å·ï¼‰ï¼š

   ![image-20180919173323821](/Users/panhui/Library/Application Support/typora-user-images/image-20180919173323821.png)

   é…ç½®å®Œåï¼Œç”µè„‘ä¼šæœ‰ä¸ªè”å…¥çš„æç¤ºï¼Œé€‰æ‹©`Allow`ã€‚ï¼ˆçœŸæœºçš„å¼Šç«¯æ˜¯ç¬”è®°æœ¬ç”µè„‘æœ‰æ—¶è¿CMBC-Tï¼Œç”µè„‘çš„ipä¼šå˜ï¼Œå¦‚æœå‘ç°ä¸èƒ½ç”¨éœ€è¦å»æ”¹å˜æ‰‹æœºçš„ä»£ç†ä¸»æœºï¼‰





## å¼€å§‹è°ƒè¯•

1. æ‰“å¼€Appï¼Œæ‰“å¼€æƒ³è°ƒè¯•çš„é¡µé¢ï¼Œä½ ä¼šåœ¨Charlesä¸­å‘ç°å¦‚ä¸‹ç»“æ„ï¼ˆè¯·ç”¨ä¸‹æ–¹Filterè¿‡æ»¤ï¼Œè§„åˆ™å†™cmbcå°±è¡Œï¼‰ï¼š![image-20180919181515018](/Users/panhui/Library/Application Support/typora-user-images/image-20180919181515018.png)

2. **å¦‚æœåšäº†æœ¬åœ°æ˜ å°„çš„è¯**ï¼Œå°è¯•ä¿®æ”¹æœ¬åœ°æ–‡ä»¶ã€ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢ï¼Œå³å¯çœ‹åˆ°æ•ˆæœã€‚

3. å¦‚æœä½ æ˜¯iPhone+Windowsï¼Œé‚£ç›®å‰åªèƒ½è¿™æ ·äº†ã€‚

   ä½†è¿™æ ·ä¼¼ä¹åªèƒ½çœ‹æ•ˆæœï¼Œè€Œæ— æ³•debugï¼ˆè™½è¯´åœ¨å¼€å‘æœºä¸Šå¯ä»¥è°ƒè¯•é¡µé¢ç”šè‡³æ¥å£ï¼Œä½†ä½ æ€»æ˜¯æ— æ³•å®Œç¾æ¨¡æ‹Ÿæ‰‹æœºæ˜¾ç¤ºå™¨çš„åŒºåŸŸé¢ç§¯ï¼Œæ— æ³•è°ƒè¯•jsBridgeï¼Œä»¥åŠç¬¬ä¸‰æ–¹çš„é¡µé¢ï¼‰ã€‚


4. ä½†å¦‚æœä½ æ˜¯Androidæ‰‹æœºï¼ˆæ— è®ºä»€ä¹ˆç”µè„‘ä½†å‰æè¦å·²ç»ç¿»å¢™ï¼‰ï¼Œå¯ä»¥å…ˆè®©Androidå¼€å‘åŒäº‹æ‰“ä¸€ä¸ªèƒ½å¤Ÿå¯¹webviewè¿›è¡Œdebugçš„åŒ…ï¼ˆå®‰å“ä»£ç æ·»åŠ ï¼š`WebView.setWebContentsDebuggingEnabled(true);`ï¼Œå¹¶ä¸”æ‰“å‡ºæ¥çš„åŒ…æœ€å¥½èƒ½é€‰æœåŠ¡å™¨åœ°å€ï¼‰ï¼Œå†å°†æ‰‹æœºè¿ä¸Šç”µè„‘å¹¶ä¸”å¼€å¯å¼€å‘è€…æ¨¡å¼+USBè°ƒè¯•ï¼Œç„¶åæ‰“å¼€ç”µè„‘çš„Chromeï¼Œåœ°å€æ è¾“å…¥â€œ`chrome://inspect`â€ï¼Œä½ å°±ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒChromeæ¢æµ‹åˆ°äº†ä½ çš„æ‰‹æœºï¼š

   ![image-20180920084911468](/Users/panhui/Library/Application Support/typora-user-images/image-20180920084911468.png)

   ç„¶åæ‰“å¼€Appï¼Œæ‰“å¼€ä½ æƒ³è°ƒè¯•çš„é¡µé¢ï¼Œä½ ä¼šåœ¨Chromeä¸­çœ‹åˆ°å¦‚ä¸‹å›¾çš„webviewæ¢æµ‹æç¤ºï¼Œç‚¹å‡»`inspect`ï¼š![image-20180920085413631](/Users/panhui/Library/Application Support/typora-user-images/image-20180920085413631.png)

   ç„¶åä½ å°±ä¼šçœ‹åˆ°ä¸€ä¸ªç±»ä¼¼Chromeçš„Dev Toolsçš„å·¥å…·å‡ºç°äº†å¦‚ä¸‹å›¾ï¼Œç‚¹å‡»ç®­å¤´æ‰€æŒ‡çš„`Toggle Screencast`å¯ä»¥åˆ‡æ¢æ˜¯å¦éœ€è¦æˆªå±ï¼ˆä¹Ÿå°±æ˜¯æ˜¯å¦æ˜¾ç¤ºå·¦ä¾§åŒºåŸŸï¼‰ã€‚å¦‚æœä½ ç”µè„‘æ²¡å‡ºç°ï¼Œè¯´æ˜ä½ éœ€è¦ç¿»å¢™ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡è¦ä¸‹è½½Googleçš„æŸäº›ç»„ä»¶å·¥å…·ï¼Œä¹‹åå°±ä¸ç”¨ç¿»å¢™äº†ï¼ˆä¸åŒç‰ˆæœ¬çš„webviewéƒ½éœ€è¦å•ç‹¬ä¸‹è½½ï¼Œä¹Ÿå°±æ˜¯è¯´æ¢äº†ä¸ªæ‰‹æœºå¾ˆæœ‰å¯èƒ½è¦å†ä¸‹è½½Googleç»„ä»¶ï¼›è€Œä¸”æœ‰äº›ç”µè„‘ä¼šè‡ªåŠ¨æ¸…ç†è¿™äº›ç»„ä»¶ï¼Œå°šä¸æ¸…æ¥šæ˜¯ä½•åŸå› ï¼Œå¦‚æœæŸæ¬¡å‘ç°åˆæ‰“ä¸å¼€ï¼Œè¯·å†æ¬¡ç¿»å¢™ï¼‰ã€‚

   ![image-20180920085812799](/Users/panhui/Library/Application Support/typora-user-images/image-20180920085812799.png)

   æ¥ä¸‹æ¥ï¼Œæœ‰äº†Dev Toolsï¼Œä½ è¯¥ä¼šdebugäº†å§ğŸ˜Šã€‚

5. å¦‚æœä½ æ˜¯Macç”µè„‘ï¼Œæ­å–œä½ ï¼Œä½ è¿˜èƒ½è¿›è¡ŒiPhoneçš„è°ƒè¯•ï¼ˆçœŸæœºæˆ–è€…æ¨¡æ‹Ÿå™¨éƒ½è¡Œï¼Œä»¥ä¸‹æ‹¿æ¨¡æ‹Ÿå™¨ä¸¾ä¾‹ï¼‰ã€‚é¦–å…ˆä½ è¦clone iOSçš„ä»£ç åˆ°ç¬”è®°æœ¬ç”µè„‘å¹¶ä¸”å®‰è£…äº†Xcodeï¼Œä¹‹åè¯·iOSåŒäº‹å¸®ä½ æ£é¼“ä¸€ç•ªï¼ˆæœ±æ˜ŠğŸ¤ªï¼‰ï¼ˆå…·ä½“æˆ‘å°±ä¸æ¸…æ¥šäº†ï¼ŒXcodeçš„çš„æ“ä½œè‡ªå·±æ‘¸ç´¢å§ï¼‰ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªsimulatorï¼š![image-20180920091631723](/Users/panhui/Library/Application Support/typora-user-images/image-20180920091631723.png)

   ç„¶å`cmd+R`Build+Runï¼Œç„¶åä½ å°±å¾—åˆ°äº†ä¸€å°ï¼ˆå‡çš„ï¼‰iphone XS MaxğŸ¤“ï¼š![image-20180920091825923](/Users/panhui/Library/Application Support/typora-user-images/image-20180920091825923.png)

   åƒçœŸæœºä¸€æ ·å»æ“ä½œå®ƒï¼Œæ‰“å¼€è¦è°ƒè¯•çš„é¡µé¢ï¼ˆæœ‰äº›éœ€è¦å®‰å…¨é”®ç›˜è¾“å…¥çš„ï¼Œè¦ç”¨é¼ æ ‡å»ç‚¹å‡»å®‰å…¨é”®ç›˜è¾“å…¥ï¼Œå…¶ä»–ä¸€èˆ¬çš„inputç”¨ç”µè„‘é”®ç›˜è¾“å…¥å³å¯ï¼‰ï¼Œæ‰“å¼€Safariï¼Œï¼ˆå¦‚æœä½ çš„Safariæ²¡æœ‰"å¼€å‘"èœå•ï¼Œè¯·`cmd+,`æ‰“å¼€åå¥½è®¾ç½®ï¼Œç„¶åå¦‚å›¾å‹¾é€‰ï¼šï¼‰![image-20180920093014656](/Users/panhui/Library/Application Support/typora-user-images/image-20180920093014656.png)
   ç„¶åå¦‚å›¾æ“ä½œï¼š![image-20180920092917574](/Users/panhui/Library/Application Support/typora-user-images/image-20180920092917574.png)

   ä½ å°±èƒ½çœ‹åˆ°Safariçš„å¼€å‘è€…å·¥å…·äº†ï¼š![image-20180920093238161](/Users/panhui/Library/Application Support/typora-user-images/image-20180920093238161.png)

   æ¥ä¸‹æ¥çš„debugï¼Œå°±ä¸ç”¨å¤šè¯´äº†ğŸ˜Šã€‚

6. å¦‚æœä½ æƒ³ç”¨Macä¸Šçš„æ¨¡æ‹Ÿå™¨å»åšæœ¬åœ°æ˜ å°„ï¼ˆ`Map Local`ï¼‰çš„è¯ï¼Œåœ¨Charlesä¸­å¼€å¯`macOS Proxy`ï¼Œå¿«æ·é”®`shift+cmd+P`ã€‚å¼€å¯æœ¬æœºä»£ç†ä¹‹åï¼Œå‘æ¨¡æ‹Ÿå™¨å®‰è£…æ ¹è¯ä¹¦ï¼Œå¦‚å›¾ç‚¹å‡»ï¼š![image-20180920093501983](/Users/panhui/Library/Application Support/typora-user-images/image-20180920093501983.png)

   å°†æ ¹è¯ä¹¦è£…è¿›iOSæ¨¡æ‹Ÿå™¨é‡Œï¼ˆå¦‚æœç”µè„‘ç»å¸¸åˆ‡æ¢CMBC-CC2å’ŒCMBC-Tï¼Œé‚£å¯èƒ½è¦å¤šç‚¹å‡ æ¬¡ï¼‰ï¼Œæ¥ä¸‹æ¥å°±å¦‚ä¹‹å‰è¯´çœŸæœºæœ¬åœ°æ˜ å°„ä¸€æ ·äº†ã€‚â€‹

